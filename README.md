# Fresh4Life
Web service about Music


# Rust Web App with Rocket, Diesel, and Tera

## Overview
This project is a full-stack web application built using the **Rust** programming language with the **Rocket** web framework. It provides user authentication (registration, login, and logout), session management with cookies, and dynamic template rendering using **Tera**. The application interacts with a **MySQL** database through **Diesel**, an ORM and query builder, and uses **bcrypt** for secure password hashing. Static files are served from a dedicated directory, and the application follows a modular structure for maintainability.

The app includes the following features:
- **User Registration**: Create a new user account with a username and securely hashed password.
- **User Login/Logout**: Authenticate users and manage sessions using cookies.
- **Dynamic Templates**: Render HTML pages dynamically with Tera templates.
- **Database Integration**: Store and retrieve user data using Diesel with a MySQL backend.
- **Static File Serving**: Serve CSS, JavaScript, and other static assets.
- **Secure Password Storage**: Hash passwords using bcrypt for enhanced security.

## Tech Stack
- **Rust**: The programming language used for the backend.
- **Rocket**: A web framework for building fast and secure web applications in Rust.
- **Diesel**: A safe and extensible ORM and query builder for interacting with the MySQL database.
- **Tera**: A template engine inspired by Jinja2 for rendering dynamic HTML templates.
- **MySQL**: The relational database used for persistent storage.
- **bcrypt**: A library for securely hashing passwords.
- **dotenv**: For managing environment variables, such as the database connection URL.
- **r2d2**: A connection pooling library for managing database connections efficiently.

## Project Structure
```
├── src
│   ├── main.rs              # Main application logic, routes, and Rocket setup
│   ├── models.rs           # Data models for users
│   ├── schema.rs           # Database schema generated by Diesel
├── templates
│   ├── index.html          # Homepage template
│   ├── about.html          # About page template
│   ├── user.html           # User profile page template
│   ├── register.html       # Registration form template
│   ├── login.html          # Login form template
│   ├── tracks.html         # Track list template
│   ├── upload.html         # Upload form template
├── static
│   ├── css
│   ├── js
│   ├── images
├── .env                    # Environment variables (e.g., DATABASE_URL)
├── Cargo.toml             # Rust project dependencies and configuration
├── diesel.toml            # Diesel configuration for schema generation
```

## Setup and Installation

### Prerequisites
- **Rust**: Install Rust and Cargo using [rustup](https://rustup.rs/).
- **MySQL**: Install and set up a MySQL server.
- **Diesel CLI**: Install Diesel CLI with MySQL support:
  ```bash
  cargo install diesel_cli --no-default-features --features mysql
  ```
- **Environment Variables**: Create a `.env` file in the project root with the following:
  ```env
  DATABASE_URL=mysql://username:password@localhost/database_name
  ```

### Installation Steps
1. **Clone the Repository**:
   ```bash
   git clone https://github.com/ovezthaking/Fresh4Life.git
   cd Fresh4Life
   ```

2. **Set Up the Database**:
   - Create a MySQL database:
     ```sql
     CREATE DATABASE database_name;
     ```
   - Run Diesel migrations to set up the schema:
     ```bash
     diesel setup
     diesel migration run
     ```

3. **Install Dependencies**:
   ```bash
   cargo build
   ```

4. **Run the Application**:
   ```bash
   cargo run
   ```
   The application will be available at `http://localhost:8000`.

## Usage
- **Homepage (`/`)**: Displays a welcome page with user information if logged in, or a default message if not.
- **About Page (`/about`)**: A static page with information about the application.
- **User Profile (`/user/<id>`)**: Displays a user profile page for the specified user ID.
- **Register (`/register`)**: Allows users to create a new account with a username and password.
- **Login (`/login`)**: Authenticates users and sets a session cookie (`user_id`).
- **Logout (`/logout`)**: Removes the session cookie and redirects to the homepage.
- **Static Files**: Access static assets (e.g., CSS, JS) at `/static/*`.

## Routes
| Method | Path              | Description                          |
|--------|-------------------|--------------------------------------|
| GET    | `/`               | Renders the homepage                 |
| GET    | `/about`          | Renders the about page               |
| GET    | `/user/<id>`      | Renders a user profile page          |
| GET    | `/register`       | Renders the registration form        |
| POST   | `/register`       | Processes registration form          |
| GET    | `/login`          | Renders the login form               |
| POST   | `/login`          | Authenticates user and sets cookie   |
| GET    | `/logout`         | Clears session cookie and redirects  |
| GET    | `/upload`         | Renders the upload track form        |
| POST   | `/upload`         | Processes track upload form          |
| GET    | `/tracks`         | Displays a list of all uploaded tracks |

## Database Schema
The application uses a single `users` table with the following schema:
```sql
CREATE TABLE users (
    id INT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(255) NOT NULL UNIQUE,
    password VARCHAR(255) NOT NULL,
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);
```

## Security Features
- **Password Hashing**: Passwords are hashed using bcrypt with a default cost factor to ensure secure storage.
- **Session Management**: User sessions are managed with cookies, with proper logout functionality to invalidate sessions.
- **Database Connection Pooling**: Uses r2d2 for efficient and safe database connection management.
- **Error Handling**: Graceful handling of database and template rendering errors to prevent crashes.

## Contributing
Contributions are welcome! Please follow these steps:
1. Fork the repository.
2. Create a new branch (`git checkout -b feature/your-feature`).
3. Make your changes and commit (`git commit -m 'Add your feature'`).
4. Push to the branch (`git push origin feature/your-feature`).
5. Open a pull request.

## License
This project is licensed under the MIT License. See the [LICENSE](LICENSE) file for details.

## Acknowledgments
- [Rocket](https://rocket.rs/) for the web framework.
- [Diesel](https://diesel.rs/) for ORM and database interactions.
- [Tera](https://tera.netlify.app/) for template rendering.
- [bcrypt](https://crates.io/crates/bcrypt) for secure password hashing.
